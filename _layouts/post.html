<!DOCTYPE html>
<html lang="en">
  <head>
   <title>{{ page.title }} â€” {{ site.name }}</title>
    {% include meta.html %}
  </head>
  <body>
      <div class="container">
        {% include header.html %}
        <div class="container">
            <div class="postHeader">
                <span class="float-left">
                    <a href="/pages/news" class="back-to-front" title="Back to all posts">&larr; back</a>
                </span> 
                <span class="post-date float-right">
                    <em>{{ page.date | date: "%-d %B %Y" }}</em>  
                </span>
                <span style="clear:both; float:none;">&nbsp;</span> 
                <h2>{{ page.title }}</h2>
                <span class="read-time" title="Estimated read time"><small>
                    <em>{% assign words = content | number_of_words %}
                        approx {% if words < 360 %} 1 min read. 
                        {% else %} {{ words | divided_by:180 }} mins read. 
                        {% endif %} 
                    </em> 
                </small></span>
            </div>
           
            {{ content }}

            {% if page.related != false %}
            <div class="related-posts">
                <strong>Related Posts</strong>
                {% assign maxRelated = 3 %}
                {% assign minCommonTags = 1 %}
                {% assign maxRelatedCounter = 0 %}
                <ul>
                    {% for post in site.posts %}

                    {% assign sameTagCount = 0 %}
                    {% assign commonTags = '' %}

                    {% for category in post.categories %}
                    {% if post.url != page.url %}
                    {% if page.categories contains category %}
                    {% assign sameTagCount = sameTagCount | plus: 1 %}
                    {% capture tagmarkup %} {{ category }} {% endcapture %}
                    {% assign commonTags = commonTags | append: tagmarkup %}
                    {% endif %}
                    {% endif %}
                    {% endfor %}

                    {% if sameTagCount >= minCommonTags %}
                    <li>
                        <a href="{{ post.url }}">{{ post.title }}</a>
                        <br/>
                        <small>
                            <span class="date"><em>{{ post.date | date: "%-d %B %Y" }}</em></span>
                            <span class="num-words">| <em>{{ post.content | number_of_words }}</em> words</span>
                            <span class="read-time" title="Estimated read time">| <em>{% assign words = post.content | number_of_words %}approx {% if words < 360 %}1 min read.{% else %}{{ words | divided_by:180 }} mins read.{% endif %}</em></span>
                            <span class="categories">| <em>{% if post.category != empty %}{% for category in post.categories %}{{ category }}, {% endfor %}{% endif %}</em></span>
                        </small>
                    </li>
                    {% assign maxRelatedCounter = maxRelatedCounter | plus: 1 %}
                    {% if maxRelatedCounter >= maxRelated %}
                    {% break %}
                    {% endif %}
                    {% endif %}
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
 
        </div>
      {% include footer.html %}
    </div>
  </body>
</html>
